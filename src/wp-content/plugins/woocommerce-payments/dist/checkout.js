!function(){"use strict";const e=e=>("undefined"!=typeof wcpay_config?wcpay_config:wc.wcSettings.getSetting("woocommerce_payments_data"))[e]||null;var t=window.wp.i18n;window.wp.domReady;const o=e=>"object"==typeof wcpayPaymentRequestParams&&wcpayPaymentRequestParams.hasOwnProperty(e)?wcpayPaymentRequestParams[e]:null,r=e=>o("wc_ajax_url").toString().replace("%%endpoint%%","wcpay_"+e),n=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"wcpay_";return e.toString().replace("%%endpoint%%",o+t)};var a=function(t,r){var n,a,c;const s=null!==(n=e("platformTrackerNonce"))&&void 0!==n?n:null===(a=o("nonce"))||void 0===a?void 0:a.platform_tracker,i=null!==(c=e("ajaxUrl"))&&void 0!==c?c:o("ajax_url"),l=new FormData;l.append("tracksNonce",s),l.append("action","platform_tracks"),l.append("tracksEventName",t),l.append("tracksEventProp",r),fetch(i,{method:"post",body:l})},c={CONNECT_ACCOUNT_CLICKED:"wcpay_connect_account_clicked",CONNECT_ACCOUNT_VIEW:"page_view",CONNECT_ACCOUNT_LEARN_MORE:"wcpay_welcome_learn_more",CONNECT_ACCOUNT_STRIPE_CONNECTED:"wcpay_stripe_connected",CONNECT_ACCOUNT_KYC_MODAL_OPENED:"wcpay_connect_account_kyc_modal_opened",UPE_ENABLED:"wcpay_upe_enabled",UPE_DISABLED:"wcpay_upe_disabled",MULTI_CURRENCY_ENABLED_CURRENCIES_UPDATED:"wcpay_multi_currency_enabled_currencies_updated",PAYMENT_REQUEST_SETTINGS_CHANGE:"wcpay_payment_request_settings_change",SUBSCRIPTIONS_EMPTY_STATE_VIEW:"wcpay_subscriptions_empty_state_view",SUBSCRIPTIONS_EMPTY_STATE_FINISH_SETUP:"wcpay_subscriptions_empty_state_finish_setup",SUBSCRIPTIONS_EMPTY_STATE_CREATE_PRODUCT:"wcpay_subscriptions_empty_state_create_product",SUBSCRIPTIONS_ACCOUNT_NOT_CONNECTED_PRODUCT_MODAL_VIEW:"wcpay_subscriptions_account_not_connected_product_modal_view",SUBSCRIPTIONS_ACCOUNT_NOT_CONNECTED_PRODUCT_MODAL_FINISH_SETUP:"wcpay_subscriptions_account_not_connected_product_modal_finish_setup",SUBSCRIPTIONS_ACCOUNT_NOT_CONNECTED_PRODUCT_MODAL_DISMISS:"wcpay_subscriptions_account_not_connected_product_modal_dismiss",PLATFORM_CHECKOUT_OFFERED:"platform_checkout_offered",PLATFORM_CHECKOUT_OTP_START:"platform_checkout_otp_prompt_start",PLATFORM_CHECKOUT_OTP_COMPLETE:"platform_checkout_otp_prompt_complete",PLATFORM_CHECKOUT_OTP_FAILED:"platform_checkout_otp_prompt_failed",PLATFORM_CHECKOUT_AUTO_REDIRECT:"platform_checkout_auto_redirect",PLATFORM_CHECKOUT_SKIPPED:"platform_checkout_skipped"};async function s(e,t,o){const r=new FormData;for(const e in t)r.append(e,t[e]);const n=await fetch(e,{method:"POST",body:r,...o});return await n.json()}const i=(o,r)=>{let i;const l=document.querySelector(o);let u=!1;if(!l)return;const d=document.createElement("div"),p=l.parentNode;d.classList.add("wc-block-components-spinner");const m=document.createElement("div");m.setAttribute("role","dialog"),m.setAttribute("aria-modal","true");const _=document.createElement("iframe");_.title=(0,t.__)("WooPay Login Session","woocommerce-payments"),_.classList.add("platform-checkout-login-session-iframe"),_.classList.add("intrinsic-ignore"),m.insertBefore(_,null);const h=document.createElement("div");h.setAttribute("role","dialog"),h.setAttribute("aria-modal","true"),h.classList.add("platform-checkout-otp-iframe-wrapper");const w=document.createElement("iframe");w.title=(0,t.__)("WooPay SMS code verification","woocommerce-payments"),w.classList.add("platform-checkout-otp-iframe"),w.classList.add("intrinsic-ignore");const y=document.createElement("span");y.setAttribute("aria-hidden","true"),y.classList.add("arrow");const f=768;let g=!0;const v=()=>{(f<=window.innerWidth&&g||f>window.innerWidth&&!g)&&(g=!g,w.contentWindow.postMessage({action:"setHeader",value:g},e("platformCheckoutHost"))),document.body.style.overflow="hidden"},C=()=>{if(!w)return;if(f>=window.innerWidth)return w.style.left="0",void(w.style.right="");if(0>=w.getBoundingClientRect().top||0>=window.innerHeight-(w.getBoundingClientRect().height+w.getBoundingClientRect().top)){const e=50,t=document.documentElement.scrollTop+l.getBoundingClientRect().top-w.getBoundingClientRect().height/2-e;window.scrollTo({top:t})}const e=l.getBoundingClientRect(),t=w.getBoundingClientRect();w.style.top=Math.floor(e.top-t.height/2)+"px",y.style.top=Math.floor(e.top+e.height/2-parseFloat(window.getComputedStyle(y)["border-right-width"]))+"px",50>=window.innerWidth-(e.right+t.width)?(w.style.left="auto",y.style.left="auto",w.style.right="50px",y.style.right=`${t.width+50}px`):(w.style.left=`${e.right+5}px`,w.style.right="",y.style.left=e.right-10+"px",y.style.right="")};w.addEventListener("load",(()=>{g=!0,v(),window.addEventListener("resize",v),C(),window.addEventListener("resize",C),w.classList.add("open"),a(c.PLATFORM_CHECKOUT_OTP_START)})),h.insertBefore(y,null),h.insertBefore(w,null);const F=document.createElement("div");F.textContent=(0,t.__)("WooPay is unavailable at this time. Please complete your checkout below. Sorry for the inconvenience.","woocommerce-payments");const E=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];window.removeEventListener("resize",v),window.removeEventListener("resize",C),h.remove(),w.classList.remove("open"),e&&l.focus(),document.body.style.overflow=""};h.addEventListener("click",E);const k=()=>{p.insertBefore(F,l.nextSibling)};document.addEventListener("keyup",(e=>{"Escape"===e.key&&E()&&e.stopPropagation()}));let b=!1;const S=new AbortController,{signal:T}=S;T.addEventListener("abort",(()=>{d.remove(),E(!1)})),document.querySelector('form[name="checkout"]').addEventListener("submit",(()=>{S.abort()}));const P=async t=>{if(p.insertBefore(d,l),p.contains(F)&&p.removeChild(F),b&&(document.querySelector("#platform-checkout-subscriptions-login-error").remove(),b=!1),e("platformCheckoutNeedLogin"))try{const o=await s(e("userExistsEndpoint"),{email:t},{signal:T});if(o["user-exists"])return b=!0,function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n="";n=e.includes("woocommerce-error")?e:'<ul class="woocommerce-error" role="alert"'+(r?' id="'+r+'"':"")+">"+e+"</ul>";let a=jQuery(".woocommerce-notices-wrapper, form.checkout");if(a=t?a.first():a.last(),!a.length)return;jQuery(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),a.prepend('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout">'+n+"</div>"),o&&a.find(".input-text, select, input:checkbox").trigger("validate").blur();let c=jQuery(".woocommerce-NoticeGroup-checkout");c.length||(c=a),jQuery.scroll_to_notices(c),jQuery(document.body).trigger("checkout_error")}(o.message,!1,!1,"platform-checkout-subscriptions-login-error"),void d.remove()}catch(e){"AbortError"!==e.name&&(k(),d.remove())}s(n(e("wcAjaxUrl"),"get_platform_checkout_signature"),{_ajax_nonce:e("platformCheckoutSignatureNonce")}).then((e=>{if(e.success)return e.data;throw new Error("Request for signature failed.")})).then((e=>{if(e.signature)return e.signature;throw new Error("Signature not found.")})).then((o=>{const r=new URLSearchParams;return r.append("email",t),r.append("test_mode",!!e("testMode")),r.append("wcpay_version",e("wcpayVersionNumber")),r.append("blog_id",e("platformCheckoutMerchantId")),r.append("request_signature",o),fetch(`${e("platformCheckoutHost")}/wp-json/platform-checkout/v1/user/exists?${r.toString()}`,{signal:T})})).then((e=>(200!==e.status&&k(),e.json()))).then((o=>{const r=new CustomEvent("PlatformCheckoutUserCheck",{detail:{isRegisteredUser:o["user-exists"]}});window.dispatchEvent(r),o["user-exists"]?(t=>{const o=new URLSearchParams;o.append("email",t),o.append("needsHeader",f>window.innerWidth),o.append("wcpayVersion",e("wcpayVersionNumber")),w.src=`${e("platformCheckoutHost")}/otp/?${o.toString()}`,p.insertBefore(h,null),C(),w.focus()})(t):"rest_invalid_param"!==o.code&&a(c.PLATFORM_CHECKOUT_OFFERED)})).catch((e=>{"AbortError"!==e.name&&k()})).finally((()=>{d.remove()}))},D=e=>new RegExp(/^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[0-9a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]){2,}\.?$/i).test(e),O=()=>{m.remove(),_.classList.remove("open"),l.focus(),D(l.value)&&P(l.value)};window.addEventListener("pageshow",(function(t){const o=t.persisted||"undefined"!=typeof performance&&"back_forward"===performance.getEntriesByType("navigation")[0].type,r=new URLSearchParams(window.location.search);if(o||"true"===r.get("skip_platform_checkout")){a(c.PLATFORM_CHECKOUT_SKIPPED),r.delete("skip_platform_checkout");let{pathname:e}=window.location;""!==r.toString()&&(e+="?"+r.toString()),history.replaceState(null,null,e),E(!1)}else u||(t=>{const o=new URLSearchParams;D(t)&&(p.insertBefore(d,l),o.append("email",t),o.append("test_mode",!!e("testMode"))),_.src=`${e("platformCheckoutHost")}/login-session?${o.toString()}`,p.insertBefore(m,null),_.focus(),setTimeout((()=>{u||O()}),15e3)})(l.value)})),l.addEventListener("input",(e=>{if(!u)return;const t=e.currentTarget.value;clearTimeout(i),d.remove(),i=setTimeout((()=>{D(t)&&P(t)}),500)})),window.addEventListener("message",(t=>{if(e("platformCheckoutHost").startsWith(t.origin))switch(t.data.action){case"auto_redirect_to_platform_checkout":u=!0,r.initPlatformCheckout("",t.data.platformCheckoutUserSession).then((e=>{"success"===e.result?(m.classList.add("platform-checkout-login-session-iframe-wrapper"),_.classList.add("open"),a(c.PLATFORM_CHECKOUT_AUTO_REDIRECT),d.remove(),window.location=e.url):O()}));break;case"close_auto_redirection_modal":u=!0,O();break;case"redirect_to_platform_checkout":a(c.PLATFORM_CHECKOUT_OTP_COMPLETE),r.initPlatformCheckout(l.value,t.data.platformCheckoutUserSession).then((e=>{"success"===e.result?window.location=e.url:(k(),E(!1))}));break;case"otp_validation_failed":a(c.PLATFORM_CHECKOUT_OTP_FAILED);break;case"close_modal":E();break;case"iframe_height":if(300<t.data.height)if(f<=window.innerWidth){w.style.height=t.data.height+"px";const e=l.getBoundingClientRect();w.style.top=Math.floor(e.top-t.data.height/2)+"px",y.style.top=Math.floor(e.top+e.height/2-parseFloat(window.getComputedStyle(y)["border-right-width"]))+"px"}else w.style.height="",w.style.top=""}}))};class l{constructor(e,t){this.options=e,this.stripe=null,this.stripePlatform=null,this.request=t}createStripe(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];const n={locale:t};return o&&(n.stripeAccount=o),r&&(n.betas=r),new Stripe(e,n)}getStripe(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{publishableKey:t,accountId:o,forceNetworkSavedCards:r,locale:n,isUPEEnabled:a,isStripeLinkEnabled:c}=this.options;if(r&&!e)return this.stripePlatform||(this.stripePlatform=this.createStripe(t,n)),this.stripePlatform;if(!this.stripe)if(a){let e=["card_country_event_beta_1"];c&&(e=e.concat(["link_autofill_modal_beta_1"])),this.stripe=this.createStripe(t,n,o,e)}else this.stripe=this.createStripe(t,n,o);return this.stripe}loadStripe(){return new Promise((e=>{try{e(this.getStripe())}catch(t){e({error:t})}}))}generatePaymentMethodRequest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=this.getStripe();return new class{constructor(){this.args={...e,billing_details:{address:{}}}}prepareValue(e,o){if(void 0!==o&&0!==o.length||(o=t[e]),void 0!==o&&0<o.length)return o}setBillingDetail(e,t){const o=this.prepareValue(e,t);void 0!==o&&(this.args.billing_details[e]=o)}setAddressDetail(e,t){const o=this.prepareValue(e,t);void 0!==o&&(this.args.billing_details.address[e]=o)}send(){return o.createPaymentMethod(this.args).then((e=>{if(e.error)throw e.error;return e}))}}}confirmIntent(t,r){const n=t.match(/#wcpay-confirm-(pi|si):(.+):(.+):(.+)$/);if(!n)return!0;const a="si"===n[1];let c=n[2];const s=n[3],i=n[4],l=t.indexOf("order-pay"),u=-1<l,d=u&&t.substring(l).match(/\d+/);return d&&(c=d[0]),{request:(()=>{const{locale:t,publishableKey:o}=this.options,r=e("accountIdForIntentConfirmation");return a?this.getStripe().confirmCardSetup(s):r?this.createStripe(o,t,r).confirmCardPayment(s):this.getStripe(!0).confirmCardPayment(s)})().then((t=>{var n;const a=t.paymentIntent&&t.paymentIntent.id||t.setupIntent&&t.setupIntent.id||t.error&&t.error.payment_intent&&t.error.payment_intent.id||t.error.setup_intent&&t.error.setup_intent.id,s=null!==(n=o("ajax_url"))&&void 0!==n?n:e("ajaxUrl");return[this.request(s,{action:"update_order_status",order_id:c,_ajax_nonce:i,intent_id:a,payment_method_id:r||null}),t.error]})).then((e=>{let[t,o]=e;if(o)throw o;return t.then((e=>{const t="string"==typeof e?JSON.parse(e):e;if(t.error)throw t.error;return t.return_url}))})),isOrderPage:u}}initSetupIntent(){return this.request(n(e("wcAjaxUrl"),"init_setup_intent"),{_ajax_nonce:e("createSetupIntentNonce")}).then((e=>{if(!e.success)throw e.data.error;return e.data}))}setupIntent(t){return this.request(e("ajaxUrl"),{action:"create_setup_intent","wcpay-payment-method":t,_ajax_nonce:e("createSetupIntentNonce")}).then((e=>{if(!e.success)throw e.data.error;return"succeeded"===e.data.status?e.data:this.getStripe().confirmCardSetup(e.data.client_secret).then((e=>{const{setupIntent:t,error:o}=e;if(o)throw o;return t}))}))}createIntent(t){return this.request(n(e("wcAjaxUrl"),"create_payment_intent"),{wcpay_order_id:t,_ajax_nonce:e("createPaymentIntentNonce")}).then((e=>{if(!e.success)throw e.data.error;return e.data})).catch((e=>{throw e.message?e:new Error(e.statusText)}))}updateIntent(t,o,r,a,c){return this.request(n(e("wcAjaxUrl"),"update_payment_intent"),{wcpay_order_id:o,wc_payment_intent_id:t,save_payment_method:r,wcpay_selected_upe_payment_type:a,wcpay_payment_country:c,_ajax_nonce:e("updatePaymentIntentNonce")}).then((e=>{if("failure"===e.result)throw new Error(e.messages);return e})).catch((e=>{throw e.message?e:new Error(e.statusText)}))}async handlePaymentConfirmation(e,t,o){const r=this.getStripe(),n=await r.confirmPayment({elements:e,confirmParams:t});if(o&&n.error&&"lock_timeout"===n.error.code){const e=await r.retrievePaymentIntent(o);if(!e.error&&"succeeded"===e.paymentIntent.status)return window.location.href=t.redirect_url,e}return n}saveUPEAppearance(t){let o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.request(e("ajaxUrl"),{is_blocks_checkout:o,appearance:JSON.stringify(t),action:"save_upe_appearance",_ajax_nonce:e("saveUPEAppearanceNonce")}).then((e=>e.success)).catch((e=>{throw e.message?e:new Error(e.statusText)}))}processCheckout(t,o){return this.request(n(e("wcAjaxUrl"),"checkout",""),{...o,wc_payment_intent_id:t}).then((e=>{if("failure"===e.result)throw new Error(e.messages);return e})).catch((e=>{throw e.message?e:new Error(e.statusText)}))}paymentRequestCalculateShippingOptions(e){var t;return this.request(r("get_shipping_options"),{security:null===(t=o("nonce"))||void 0===t?void 0:t.shipping,is_product_page:o("is_product_page"),...e})}paymentRequestUpdateShippingDetails(e){var t;return this.request(r("update_shipping_method"),{security:null===(t=o("nonce"))||void 0===t?void 0:t.update_shipping,shipping_method:[e.id],is_product_page:o("is_product_page")})}paymentRequestGetCartDetails(){var e;return this.request(r("get_cart_details"),{security:null===(e=o("nonce"))||void 0===e?void 0:e.get_cart_details})}paymentRequestAddToCart(e){var t;return this.request(r("add_to_cart"),{security:null===(t=o("nonce"))||void 0===t?void 0:t.add_to_cart,...e})}paymentRequestGetSelectedProductData(e){var t;return this.request(r("get_selected_product_data"),{security:null===(t=o("nonce"))||void 0===t?void 0:t.get_selected_product_data,...e})}paymentRequestCreateOrder(e){var t;return this.request(r("create_order"),{_wpnonce:null===(t=o("nonce"))||void 0===t?void 0:t.checkout,...e})}initPlatformCheckout(t,o){return this.request(n(e("wcAjaxUrl"),"init_platform_checkout"),{_wpnonce:e("initPlatformCheckoutNonce"),email:t,user_session:o})}paymentRequestPayForOrder(e,t){var n;return this.request(r("pay_for_order"),{_wpnonce:null===(n=o("nonce"))||void 0===n?void 0:n.pay_for_order,order:e,...t})}logPaymentError(t){return this.request(n(e("wcAjaxUrl"),"log_payment_error"),{charge_id:t,_ajax_nonce:e("logPaymentErrorNonce")}).then((()=>!0))}}const u="https://cdn.sift.com/s.js",d="https://js.stripe.com/v3",p={sift:e=>{let{beacon_key:t,session_id:o,user_id:r}=e;const n=window._sift=window._sift||[];if(n.push(["_setAccount",t]),n.push(["_setUserId",r]),n.push(["_setSessionId",o]),n.push(["_trackPageview"]),!document.querySelector(`[src="${u}"]`)){const e=document.createElement("script");e.src=u,e.async=!0,document.body.appendChild(e)}},stripe:()=>{if(!document.querySelector(`[src^="${d}"]`)){const e=document.createElement("script");e.src=d,e.async=!0,document.body.appendChild(e)}}};jQuery((function(t){(e=>{for(const t in e){const o=p[t];o&&e[t]&&o(e[t])}})(e("fraudServices"));const o=e("publishableKey");if(!o)return;const r=new l({publishableKey:o,accountId:e("accountId"),forceNetworkSavedCards:e("forceNetworkSavedCards"),locale:e("locale")},((e,t)=>new Promise(((o,r)=>{jQuery.post(e,t).then(o).fail(r)})))),n=r.getStripe().elements(),a="undefined"!=typeof wcpayCustomerData?wcpayCustomerData:{},c=n.create("card",{hidePostalCode:!0,classes:{base:"wcpay-card-mounted"}}),s={type:"card",card:c},u={type:"giropay"},d=n.create("iban",{supportedCountries:["SEPA"],classes:{base:"wcpay-sepa-mounted"}}),m={type:"sepa_debit",sepa_debit:d},_={type:"sofort"},h=e=>{e.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},w=e=>{let o="";o=e.includes("woocommerce-error")?e:'<ul class="woocommerce-error" role="alert">'+e+"</ul>";const r=t(".woocommerce-notices-wrapper, form.checkout").first();if(!r.length)return;t(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),r.prepend('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout">'+o+"</div>"),r.find(".input-text, select, input:checkbox").trigger("validate").blur();let n=t(".woocommerce-NoticeGroup-checkout");n.length||(n=r),t.scroll_to_notices(n),t(document.body).trigger("checkout_error")},y=function(){return t("#payment_method_woocommerce_payments_giropay").is(":checked")},f=function(){return t("#payment_method_woocommerce_payments_sepa").is(":checked")},g=function(){return t("#payment_method_woocommerce_payments_sofort").is(":checked")};let v;t(document.body).on("updated_checkout",(()=>{t("#wcpay-card-element").length&&!t("#wcpay-card-element").children().length&&(c.unmount(),c.mount("#wcpay-card-element")),t("#wcpay-sepa-element").length&&d.mount("#wcpay-sepa-element")})),(t("form#add_payment_method").length||t("form#order_review").length)&&(t("#wcpay-card-element").length&&!t("#wcpay-card-element").children().length&&c.mount("#wcpay-card-element"),t("#wcpay-sepa-element").length&&d.mount("#wcpay-sepa-element"),t(document.body).trigger("wc-credit-card-form-init")),c.addEventListener("change",(e=>{const o=t("#wcpay-errors");e.error?o.html('<ul class="woocommerce-error"><li /></ul>').find("li").text(e.error.message):o.empty()})),d.addEventListener("change",(e=>{const o=t("#wcpay-sepa-errors");e.error?o.html('<ul class="woocommerce-error"><li /></ul>').find("li").text(e.error.message):o.empty()}));const C=(e,o)=>{r.setupIntent(o.id).then((function(o){e.append(t('<input type="hidden" />').attr("id","wcpay-setup-intent").attr("name","wcpay-setup-intent").val(o.id));const r=t.blockUI.defaults.ignoreIfBlocked;t.blockUI.defaults.ignoreIfBlocked=!0,e.removeClass("processing").submit(),t.blockUI.defaults.ignoreIfBlocked=r})).catch((function(t){v=null,e.removeClass("processing").unblock(),w(t.message)}))},F=(e,o)=>{let{id:r}=o;const n=f()?"#wcpay-payment-method-sepa":"#wcpay-payment-method";t(n).val(r),e.removeClass("processing").submit()},E=(e,o,n)=>{if(v)return void(v=null);h(e);const c=r.generatePaymentMethodRequest(n,a),s=t("#billing_first_name").length?(t("#billing_first_name").val()+" "+t("#billing_last_name").val()).trim():void 0;return c.setBillingDetail("name",s),c.setBillingDetail("email",t("#billing_email").val()),c.setBillingDetail("phone",t("#billing_phone").val()),c.setAddressDetail("city",t("#billing_city").val()),c.setAddressDetail("country",t("#billing_country").val()),c.setAddressDetail("line1",t("#billing_address_1").val()),c.setAddressDetail("line2",t("#billing_address_2").val()),c.setAddressDetail("postal_code",t("#billing_postcode").val()),c.setAddressDetail("state",t("#billing_state").val()),c.send().then((t=>{let{paymentMethod:r}=t;v=!0,o(e,r)})).catch((t=>{e.removeClass("processing").unblock(),w(t.message)})),!1},k=()=>{let o=window.location.href;const n=e("intentSecret");if(n){const t="#wcpay-confirm-pi:0:"+n+":"+e("updateOrderNonce");o=window.location.pathname+window.location.search+t}const a=f()?t("#wcpay-payment-method-sepa").val():t("#wcpay-payment-method").val(),c=t("#wc-woocommerce_payments-new-payment-method").is(":checked"),s=r.confirmIntent(o,c?a:null);if(!0===s)return;const{request:i,isOrderPage:l}=s;l&&(h(t("#order_review")),t("#payment").hide(500)),history.replaceState("",document.title,window.location.pathname+window.location.search),i.then((e=>{window.location=e})).catch((o=>{t("form.checkout").removeClass("processing").unblock(),t("#order_review").removeClass("processing").unblock(),t("#payment").show(500);let r=o.message;o instanceof Error&&(r=e("genericErrorMessage")),w(r)}))};function b(){return!y()&&(f()?t("#wc-woocommerce_payments_sepa-payment-token-new").length&&!t("#wc-woocommerce_payments_sepa-payment-token-new").is(":checked"):t("#wc-woocommerce_payments-payment-token-new").length&&!t("#wc-woocommerce_payments-payment-token-new").is(":checked"))}const S=["woocommerce_payments_becs","woocommerce_payments","woocommerce_payments_giropay","woocommerce_payments_sepa","woocommerce_payments_sofort"].map((e=>`checkout_place_order_${e}`)).join(" ");t("form.checkout").on(S,(function(){if(!b()){let e=s;return f()?e=m:y()?e=u:g()&&(_.sofort={country:t("#billing_country").val()},e=_),E(t(this),F,e)}})),t("#order_review").on("submit",(()=>{if(!b()&&(document.getElementById("payment_method_woocommerce_payments").checked||f()))return E(t("#order_review"),F,f()?m:s)})),t("form#add_payment_method").on("submit",(function(){if("woocommerce_payments"===t("#add_payment_method input:checked[name='payment_method']").val()&&!t("#wcpay-setup-intent").val()){let e=s;return f()?e=m:y()?e=u:g()&&(e=_),E(t("form#add_payment_method"),C,e)}})),k(),window.addEventListener("hashchange",(()=>{window.location.hash.startsWith("#wcpay-confirm-")&&k()})),e("isPlatformCheckoutEnabled")&&null===new URLSearchParams(window.location.search).get("customize_messenger_channel")&&!e("isPreview")&&i("#billing_email",r)}))}();